cp_servers/mcp-integration-coordinator/src/web/app.html</path>
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCP Integration Coordinator - Human Oversight</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f5f5f5;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
            border-radius: 10px;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .card {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s;
        }

        .card:hover {
            transform: translateY(-2px);
        }

        .card h3 {
            color: #667eea;
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }

        .stat {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
            border-bottom: 1px solid #eee;
        }

        .stat:last-child {
            border-bottom: none;
        }

        .stat-value {
            font-weight: bold;
            font-size: 1.2rem;
        }

        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .status-pending {
            background-color: #fff3cd;
            color: #856404;
        }

        .status-approved {
            background-color: #d4edda;
            color: #155724;
        }

        .status-rejected {
            background-color: #f8d7da;
            color: #721c24;
        }

        .status-completed {
            background-color: #cce5ff;
            color: #004085;
        }

        .tabs {
            display: flex;
            background: white;
            border-radius: 10px;
            padding: 0.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .tab {
            flex: 1;
            padding: 1rem;
            text-align: center;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }

        .tab.active {
            background: #667eea;
            color: white;
        }

        .tab:hover:not(.active) {
            background: #f0f0f0;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .assessment-item,
        .remediation-item {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .item-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
        }

        .item-meta {
            display: flex;
            gap: 1rem;
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 1rem;
        }

        .item-details {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .action-buttons {
            display: flex;
            gap: 1rem;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5a6fd8;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #218838;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .loading {
            text-align: center;
            padding: 2rem;
            color: #666;
        }

        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .success {
            background: #d4edda;
            color: #155724;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .severity-high {
            color: #dc3545;
            font-weight: bold;
        }

        .severity-medium {
            color: #fd7e14;
            font-weight: bold;
        }

        .severity-low {
            color: #28a745;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            h1 {
                font-size: 2rem;
            }

            .dashboard {
                grid-template-columns: 1fr;
            }

            .tabs {
                flex-direction: column;
            }

            .action-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <header>
            <h1>MCP Integration Coordinator</h1>
            <p class="subtitle">Human Oversight Dashboard</p>
        </header>

        <div class="dashboard">
            <div class="card">
                <h3>System Status</h3>
                <div class="stat">
                    <span>Overall Status</span>
                    <span class="status-badge status-completed">Healthy</span>
                </div>
                <div class="stat">
                    <span>Active Connections</span>
                    <span class="stat-value" id="activeConnections">0</span>
                </div>
                <div class="stat">
                    <span>Uptime</span>
                    <span class="stat-value" id="uptime">0s</span>
                </div>
            </div>

            <div class="card">
                <h3>Assessments</h3>
                <div class="stat">
                    <span>Total</span>
                    <span class="stat-value" id="totalAssessments">0</span>
                </div>
                <div class="stat">
                    <span>Pending</span>
                    <span class="stat-value" id="pendingAssessments">0</span>
                </div>
                <div class="stat">
                    <span>Completed</span>
                    <span class="stat-value" id="completedAssessments">0</span>
                </div>
            </div>

            <div class="card">
                <h3>Remediation</h3>
                <div class="stat">
                    <span>Total Proposals</span>
                    <span class="stat-value" id="totalRemediations">0</span>
                </div>
                <div class="stat">
                    <span>Pending Approval</span>
                    <span class="stat-value" id="pendingApprovals">0</span>
                </div>
                <div class="stat">
                    <span>Approved</span>
                    <span class="stat-value" id="approvedRemediations">0</span>
                </div>
            </div>

            <div class="card">
                <h3>Security</h3>
                <div class="stat">
                    <span>Critical Issues</span>
                    <span class="stat-value severity-high" id="criticalIssues">0</span>
                </div>
                <div class="stat">
                    <span>High Priority</span>
                    <span class="stat-value severity-medium" id="highIssues">0</span>
                </div>
                <div class="stat">
                    <span>Medium Priority</span>
                    <span class="stat-value severity-low" id="mediumIssues">0</span>
                </div>
            </div>
        </div>

        <div class="tabs">
            <div class="tab active" onclick="switchTab('assessments')">Assessments</div>
            <div class="tab" onclick="switchTab('remediations')">Remediation Proposals</div>
            <div class="tab" onclick="switchTab('audit')">Audit Logs</div>
        </div>

        <div id="assessments" class="tab-content active">
            <div id="assessmentsList">
                <div class="loading">Loading assessments...</div>
            </div>
        </div>

        <div id="remediations" class="tab-content">
            <div id="remediationsList">
                <div class="loading">Loading remediation proposals...</div>
            </div>
        </div>

        <div id="audit" class="tab-content">
            <div id="auditLogs">
                <div class="loading">Loading audit logs...</div>
            </div>
        </div>
    </div>

    <script>
        // API Configuration
        const API_BASE = 'http://localhost:3001/api';
        let authToken = localStorage.getItem('authToken');

        // Initialize the dashboard
        document.addEventListener('DOMContentLoaded', function () {
            if (!authToken) {
                showLogin();
                return;
            }

            loadDashboard();
            loadAssessments();
            loadRemediations();
            loadAuditLogs();

            // Update dashboard every 30 seconds
            setInterval(loadDashboard, 30000);
        });

        // Tab switching
        function switchTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });

            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Show selected tab content
            document.getElementById(tabName).classList.add('active');

            // Add active class to clicked tab
            event.target.classList.add('active');
        }

        // Load dashboard data
        async function loadDashboard() {
            try {
                const response = await fetch(`${API_BASE}/dashboard`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    }
                });

                if (!response.ok) throw new Error('Failed to load dashboard');

                const data = await response.json();
                updateDashboardStats(data.stats);
            } catch (error) {
                console.error('Error loading dashboard:', error);
            }
        }

        // Update dashboard statistics
        function updateDashboardStats(stats) {
            document.getElementById('activeConnections').textContent = stats.activeConnections || 0;
            document.getElementById('uptime').textContent = formatUptime(stats.uptime || 0);
            document.getElementById('totalAssessments').textContent = stats.totalAssessments || 0;
            document.getElementById('pendingAssessments').textContent = stats.pendingAssessments || 0;
            document.getElementById('completedAssessments').textContent = stats.completedAssessments || 0;
            document.getElementById('totalRemediations').textContent = stats.totalRemediations || 0;
            document.getElementById('pendingApprovals').textContent = stats.pendingApprovals || 0;
            document.getElementById('approvedRemediations').textContent = stats.approvedRemediations || 0;
            document.getElementById('criticalIssues').textContent = stats.criticalIssues || 0;
            document.getElementById('highIssues').textContent = stats.highIssues || 0;
            document.getElementById('mediumIssues').textContent = stats.mediumIssues || 0;
        }

        // Load assessments
        async function loadAssessments() {
            try {
                const response = await fetch(`${API_BASE}/assessment/list`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    }
                });

                if (!response.ok) throw new Error('Failed to load assessments');

                const data = await response.json();
                displayAssessments(data.assessments || []);
            } catch (error) {
                console.error('Error loading assessments:', error);
                document.getElementById('assessmentsList').innerHTML = '<div class="error">Failed to load assessments</div>';
            }
        }

        // Display assessments
        function displayAssessments(assessments) {
            const container = document.getElementById('assessmentsList');

            if (assessments.length === 0) {
                container.innerHTML = '<div class="loading">No assessments found</div>';
                return;
            }

            container.innerHTML = assessments.map(assessment => `
                <div class="assessment-item">
                    <div class="item-header">
                        <div class="item-title">${assessment.title || 'Assessment ' + assessment.id}</div>
                        <span class="status-badge status-${assessment.status}">${assessment.status}</span>
                    </div>
                    <div class="item-meta">
                        <span>Started: ${formatDate(assessment.startTime)}</span>
                        <span>Type: ${assessment.type || 'compliance'}</span>
                    </div>
                    <div class="item-details">
                        <p><strong>Servers:</strong> ${assessment.servers?.join(', ') || 'All'}</p>
                        <p><strong>Summary:</strong> ${assessment.summary || 'No summary available'}</p>
                        ${assessment.issues ? `<p><strong>Issues Found:</strong> ${assessment.issues.length}</p>` : ''}
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-primary" onclick="viewAssessment('${assessment.id}')">View Details</button>
                        ${assessment.status === 'pending' ? `
                            <button class="btn btn-success" onclick="approveAssessment('${assessment.id}')">Approve</button>
                            <button class="btn btn-danger" onclick="rejectAssessment('${assessment.id}')">Reject</button>
                        ` : ''}
                    </div>
                </div>
            `).join('');
        }

        // Load remediation proposals
        async function loadRemediations() {
            try {
                const response = await fetch(`${API_BASE}/remediation/list`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    }
                });

                if (!response.ok) throw new Error('Failed to load remediations');

                const data = await response.json();
                displayRemediations(data.proposals || []);
            } catch (error) {
                console.error('Error loading remediations:', error);
                document.getElementById('remediationsList').innerHTML = '<div class="error">Failed to load remediation proposals</div>';
            }
        }

        // Display remediation proposals
        function displayRemediations(proposals) {
            const container = document.getElementById('remediationsList');

            if (proposals.length === 0) {
                container.innerHTML = '<div class="loading">No remediation proposals found</div>';
                return;
            }

            container.innerHTML = proposals.map(proposal => `
                <div class="remediation-item">
                    <div class="item-header">
                        <div class="item-title">Remediation Proposal ${proposal.id}</div>
                        <span class="status-badge status-${proposal.status}">${proposal.status}</span>
                    </div>
                    <div class="item-meta">
                        <span>Created: ${formatDate(proposal.createdAt)}</span>
                        <span>Priority: ${proposal.priority || 'medium'}</span>
                        <span>Actions: ${proposal.actions?.length || 0}</span>
                    </div>
                    <div class="item-details">
                        <p><strong>Assessment ID:</strong> ${proposal.assessmentId}</p>
                        <p><strong>Description:</strong> ${proposal.description || 'No description available'}</p>
                        <p><strong>Estimated Time:</strong> ${proposal.estimatedTime || 0} minutes</p>
                        ${proposal.riskAssessment ? `<p><strong>Risk Level:</strong> <span class="severity-${proposal.riskAssessment.level}">${proposal.riskAssessment.level}</span></p>` : ''}
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-primary" onclick="viewRemediation('${proposal.id}')">View Details</button>
                        ${proposal.status === 'pending' ? `
                            <button class="btn btn-success" onclick="approveRemediation('${proposal.id}')">Approve</button>
                            <button class="btn btn-danger" onclick="rejectRemediation('${proposal.id}')">Reject</button>
                        ` : ''}
                    </div>
                </div>
            `).join('');
        }

        // Load audit logs
        async function loadAuditLogs() {
            try {
                const response = await fetch(`${API_BASE}/audit/logs?limit=50`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    }
                });

                if (!response.ok) throw new Error('Failed to load audit logs');

                const data = await response.json();
                displayAuditLogs(data.logs || []);
            } catch (error) {
                console.error('Error loading audit logs:', error);
                document.getElementById('auditLogs').innerHTML = '<div class="error">Failed to load audit logs</div>';
            }
        }

        // Display audit logs
        function displayAuditLogs(logs) {
            const container = document.getElementById('auditLogs');

            if (logs.length === 0) {
                container.innerHTML = '<div class="loading">No audit logs found</div>';
                return;
            }

            container.innerHTML = logs.map(log => `
                <div class="assessment-item">
                    <div class="item-header">
                        <div class="item-title">${log.action}</div>
                        <span class="status-badge status-${log.result}">${log.result}</span>
                    </div>
                    <div class="item-meta">
                        <span>Time: ${formatDate(log.timestamp)}</span>
                        <span>Actor: ${log.actor}</span>
                        <span>Target: ${log.target}</span>
                    </div>
                    <div class="item-details">
                        <p><strong>Details:</strong> ${JSON.stringify(log.details, null, 2)}</p>
                        ${log.ipAddress ? `<p><strong>IP:</strong> ${log.ipAddress}</p>` : ''}
                        ${log.userAgent ? `<p><strong>User Agent:</strong> ${log.userAgent}</p>` : ''}
                    </div>
                </div>
            `).join('');
        }

        // Action handlers
        async function approveAssessment(assessmentId) {
            if (!confirm('Are you sure you want to approve this assessment?')) return;

            try {
                const response = await fetch(`${API_BASE}/assessment/${assessmentId}/approve`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        decision: 'approved',
                        reason: 'Approved by human oversight'
                    })
                });

                if (response.ok) {
                    showSuccess('Assessment approved successfully');
                    loadAssessments();
                } else {
                    showError('Failed to approve assessment');
                }
            } catch (error) {
                console.error('Error approving assessment:', error);
                showError('Failed to approve assessment');
            }
        }

        async function rejectAssessment(assessmentId) {
            if (!confirm('Are you sure you want to reject this assessment?')) return;

            try {
                const response = await fetch(`${API_BASE}/assessment/${assessmentId}/reject`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        decision: 'rejected',
                        reason: 'Rejected by human oversight'
                    })
                });

                if (response.ok) {
                    showSuccess('Assessment rejected successfully');
                    loadAssessments();
                } else {
                    showError('Failed to reject assessment');
                }
            } catch (error) {
                console.error('Error rejecting assessment:', error);
                showError('Failed to reject assessment');
            }
        }

        async function approveRemediation(proposalId) {
            if (!confirm('Are you sure you want to approve this remediation proposal?')) return;

            try {
                const response = await fetch(`${API_BASE}/remediation/approve`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        approvalId: proposalId,
                        decision: 'approved',
                        reason: 'Approved by human oversight'
                    })
                });

                if (response.ok) {
                    showSuccess('Remediation proposal approved successfully');
                    loadRemediations();
                } else {
                    showError('Failed to approve remediation proposal');
                }
            } catch (error) {
                console.error('Error approving remediation:', error);
                showError('Failed to approve remediation proposal');
            }
        }

        async function rejectRemediation(proposalId) {
            if (!confirm('Are you sure you want to reject this remediation proposal?')) return;

            try {
                const response = await fetch(`${API_BASE}/remediation/reject`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        approvalId: proposalId,
                        decision: 'rejected',
                        reason: 'Rejected by human oversight'
                    })
                });

                if (response.ok) {
                    showSuccess('Remediation proposal rejected successfully');
                    loadRemediations();
                } else {
                    showError('Failed to reject remediation proposal');
                }
            } catch (error) {
                console.error('Error rejecting remediation:', error);
                showError('Failed to reject remediation proposal');
            }
        }

        // Utility functions
        function formatUptime(seconds) {
            const hours = Math.floor(seconds / 3600);
            const minutes = Math.floor((seconds % 3600) / 60);
            const secs = seconds % 60;
            return `${hours}h ${minutes}m ${secs}s`;
        }

        function formatDate(dateString) {
            return new Date(dateString).toLocaleString();
        }

        function showSuccess(message) {
            const notification = document.createElement('div');
            notification.className = 'success';
            notification.textContent = message;
            document.body.insertBefore(notification, document.body.firstChild);
            setTimeout(() => notification.remove(), 5000);
        }

        function showError(message) {
            const notification = document.createElement('div');
            notification.className = 'error';
            notification.textContent = message;
            document.body.insertBefore(notification, document.body.firstChild);
            setTimeout(() => notification.remove(), 5000);
        }

        function showLogin() {
            document.body.innerHTML = `
                <div class="container">
                    <div style="max-width: 400px; margin: 100px auto; text-align: center;">
                        <h1>Login Required</h1>
                        <p>Please authenticate to access the human oversight dashboard.</p>
                        <button class="btn btn-primary" onclick="window.location.reload()">Try Again</button>
                    </div>
                </div>
            `;
        }

        // View functions (placeholder for detailed views)
        function viewAssessment(assessmentId) {
            alert(`Viewing assessment details for: ${assessmentId}`);
        }

        function viewRemediation(proposalId) {
            alert(`Viewing remediation details for: ${proposalId}`);
        }
    </script>
</body>

</html>